import{d as ae,a as T,r as N,k as le,c as re,e as t,w as o,g as n,E as p,o as U,b as C,O as ne,h as u,P as se,D as de,y as $,l as B,z as ie,Q as ue,A as D,_ as ce}from"./index-DhDhwFZx.js";import{s as E}from"./request-Bb0hX5IM.js";function pe(m){return E({url:"/supplier-category/list",method:"get",params:m})}function me(m){return E({url:"/supplier-category",method:"post",data:m})}function ge(m,r){return E({url:`/supplier-category/${m}`,method:"put",data:r})}function _e(m){return E({url:`/supplier-category/${m}`,method:"delete"})}function fe(m,r){return E({url:`/supplier-category/${m}/status`,method:"put",data:{status:r}})}const ye={class:"category-container"},Ce={class:"card-header"},ve={class:"search-section"},be={class:"operation-buttons"},Ve={class:"pagination-section"},we={class:"dialog-footer"},Ne=ae({__name:"category",setup(m){const r=T({categoryCode:"",categoryName:"",status:""}),i=T({currentPage:1,pageSize:20,total:0}),y=N(!1),v=N("add"),b=N(),s=T({id:null,categoryCode:"",categoryName:"",description:"",sortOrder:1,status:"ACTIVE"}),P=T({categoryName:[{required:!0,message:"请输入分类名称",trigger:"blur"}],sortOrder:[{required:!0,message:"请输入排序值",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),h=N([]),k=N(!1),_=async()=>{k.value=!0;try{const l={page:i.currentPage,limit:i.pageSize,categoryCode:r.categoryCode||void 0,categoryName:r.categoryName||void 0,status:r.status||void 0},e=await pe(l);e.code===200?(h.value=e.data.items,i.total=e.data.total):p.error(e.message||"获取分类列表失败")}catch(l){console.error("获取分类列表失败:",l),p.error("获取分类列表失败")}finally{k.value=!1}},A=()=>{i.currentPage=1,_()},F=()=>{r.categoryCode="",r.categoryName="",r.status="",A()},L=l=>{i.pageSize=l,i.currentPage=1,_()},M=l=>{i.currentPage=l,_()},R=()=>{v.value="add",x(),y.value=!0},j=l=>{v.value="edit",x(),Object.assign(s,{id:l.id,categoryCode:l.categoryCode,categoryName:l.categoryName,description:l.description,sortOrder:l.sortOrder,status:l.status}),y.value=!0},x=()=>{b.value&&b.value.resetFields(),Object.assign(s,{id:null,categoryCode:"",categoryName:"",description:"",sortOrder:1,status:"ACTIVE"})},q=async()=>{b.value&&await b.value.validate(async l=>{if(l)try{const e={...s};delete e.id;let d;v.value==="add"?d=await me(e):d=await ge(s.id,e),d.code===200?(p.success(v.value==="add"?"新增分类成功":"更新分类成功"),y.value=!1,_()):p.error(d.message||"操作失败")}catch(e){console.error("操作失败:",e),p.error("操作失败")}})},Q=async l=>{try{await D.confirm(`确定要删除分类 "${l.categoryName}" 吗？此操作不可撤销。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await _e(l.id);e.code===200?(p.success("删除分类成功"),_()):p.error(e.message||"删除分类失败")}catch(e){e!=="cancel"&&(console.error("删除分类失败:",e),p.error("删除分类失败"))}},G=async(l,e)=>{try{const d=e==="ACTIVE"?"启用":"停用";await D.confirm(`确定要${d}分类 "${l.categoryName}" 吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const c=await fe(l.id,e);c.code===200?(p.success(`${d}成功`),_()):p.error(c.message||"操作失败")}catch(d){d!=="cancel"&&(console.error("更新状态失败:",d),p.error("更新状态失败"))}},H=l=>l?new Date(l).toLocaleString("zh-CN"):"-";return le(()=>{_()}),(l,e)=>{const d=n("el-icon"),c=n("el-button"),V=n("el-input"),g=n("el-form-item"),w=n("el-option"),z=n("el-select"),S=n("el-form"),f=n("el-table-column"),J=n("el-tag"),O=n("el-dropdown-item"),K=n("el-dropdown-menu"),W=n("el-dropdown"),X=n("el-table"),Y=n("el-pagination"),Z=n("el-card"),ee=n("el-input-number"),te=n("el-dialog"),oe=se("loading");return U(),re("div",ye,[t(Z,{shadow:"never"},{header:o(()=>[C("div",Ce,[e[13]||(e[13]=C("span",null,"供应商分类管理",-1)),t(c,{type:"primary",onClick:R},{default:o(()=>[t(d,null,{default:o(()=>[t(B(ue))]),_:1}),e[12]||(e[12]=u(" 新增分类 "))]),_:1,__:[12]})])]),default:o(()=>[C("div",ve,[t(S,{model:r,inline:""},{default:o(()=>[t(g,{label:"分类编码"},{default:o(()=>[t(V,{modelValue:r.categoryCode,"onUpdate:modelValue":e[0]||(e[0]=a=>r.categoryCode=a),placeholder:"请输入分类编码",clearable:""},null,8,["modelValue"])]),_:1}),t(g,{label:"分类名称"},{default:o(()=>[t(V,{modelValue:r.categoryName,"onUpdate:modelValue":e[1]||(e[1]=a=>r.categoryName=a),placeholder:"请输入分类名称",clearable:""},null,8,["modelValue"])]),_:1}),t(g,{label:"状态"},{default:o(()=>[t(z,{modelValue:r.status,"onUpdate:modelValue":e[2]||(e[2]=a=>r.status=a),placeholder:"请选择状态",clearable:""},{default:o(()=>[t(w,{label:"全部",value:""}),t(w,{label:"启用",value:"ACTIVE"}),t(w,{label:"停用",value:"INACTIVE"})]),_:1},8,["modelValue"])]),_:1}),t(g,null,{default:o(()=>[t(c,{type:"primary",onClick:A},{default:o(()=>e[14]||(e[14]=[u("查询")])),_:1,__:[14]}),t(c,{onClick:F},{default:o(()=>e[15]||(e[15]=[u("重置")])),_:1,__:[15]})]),_:1})]),_:1},8,["model"])]),ne((U(),de(X,{data:h.value,border:"",style:{width:"100%"}},{default:o(()=>[t(f,{prop:"categoryCode",label:"分类编码",width:"120"}),t(f,{prop:"categoryName",label:"分类名称",width:"150"}),t(f,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),t(f,{prop:"sortOrder",label:"排序",width:"80"}),t(f,{prop:"status",label:"状态",width:"80"},{default:o(a=>[t(J,{type:a.row.status==="ACTIVE"?"success":"warning",size:"small"},{default:o(()=>[u($(a.row.statusText),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"createdAt",label:"创建时间",width:"150"},{default:o(a=>[u($(H(a.row.createdAt)),1)]),_:1}),t(f,{label:"操作",width:"200",fixed:"right"},{default:o(a=>[C("div",be,[t(c,{type:"primary",link:"",onClick:I=>j(a.row)},{default:o(()=>e[16]||(e[16]=[u("编辑")])),_:2,__:[16]},1032,["onClick"]),t(W,{onCommand:I=>G(a.row,I)},{dropdown:o(()=>[t(K,null,{default:o(()=>[t(O,{command:"ACTIVE",disabled:a.row.status==="ACTIVE"},{default:o(()=>e[18]||(e[18]=[u(" 启用 ")])),_:2,__:[18]},1032,["disabled"]),t(O,{command:"INACTIVE",disabled:a.row.status==="INACTIVE"},{default:o(()=>e[19]||(e[19]=[u(" 停用 ")])),_:2,__:[19]},1032,["disabled"])]),_:2},1024)]),default:o(()=>[t(c,{type:"info",link:""},{default:o(()=>[e[17]||(e[17]=u(" 状态")),t(d,{class:"el-icon--right"},{default:o(()=>[t(B(ie))]),_:1})]),_:1,__:[17]})]),_:2},1032,["onCommand"]),t(c,{type:"danger",link:"",onClick:I=>Q(a.row)},{default:o(()=>e[20]||(e[20]=[u("删除")])),_:2,__:[20]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[oe,k.value]]),C("div",Ve,[t(Y,{"current-page":i.currentPage,"onUpdate:currentPage":e[3]||(e[3]=a=>i.currentPage=a),"page-size":i.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>i.pageSize=a),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:L,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1}),t(te,{title:v.value==="add"?"新增分类":"编辑分类",modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=a=>y.value=a),width:"600px",onClose:x},{footer:o(()=>[C("div",we,[t(c,{onClick:e[10]||(e[10]=a=>y.value=!1)},{default:o(()=>e[21]||(e[21]=[u("取消")])),_:1,__:[21]}),t(c,{type:"primary",onClick:q},{default:o(()=>e[22]||(e[22]=[u("确定")])),_:1,__:[22]})])]),default:o(()=>[t(S,{ref_key:"editFormRef",ref:b,model:s,rules:P,"label-width":"100px"},{default:o(()=>[t(g,{label:"分类编码",prop:"categoryCode"},{default:o(()=>[t(V,{modelValue:s.categoryCode,"onUpdate:modelValue":e[5]||(e[5]=a=>s.categoryCode=a),placeholder:"留空自动生成"},null,8,["modelValue"])]),_:1}),t(g,{label:"分类名称",prop:"categoryName"},{default:o(()=>[t(V,{modelValue:s.categoryName,"onUpdate:modelValue":e[6]||(e[6]=a=>s.categoryName=a),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),t(g,{label:"排序",prop:"sortOrder"},{default:o(()=>[t(ee,{modelValue:s.sortOrder,"onUpdate:modelValue":e[7]||(e[7]=a=>s.sortOrder=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(g,{label:"状态",prop:"status"},{default:o(()=>[t(z,{modelValue:s.status,"onUpdate:modelValue":e[8]||(e[8]=a=>s.status=a),placeholder:"请选择状态",style:{width:"100%"}},{default:o(()=>[t(w,{label:"启用",value:"ACTIVE"}),t(w,{label:"停用",value:"INACTIVE"})]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"描述"},{default:o(()=>[t(V,{modelValue:s.description,"onUpdate:modelValue":e[9]||(e[9]=a=>s.description=a),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),ke=ce(Ne,[["__scopeId","data-v-c0fdb608"]]);export{ke as default};
